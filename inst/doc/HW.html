<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="22001" />

<meta name="date" content="2022-12-06" />

<title>Homework For StatComp</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework For StatComp</h1>
<h4 class="author">22001</h4>
<h4 class="date">2022-12-06</h4>



<p>###A-22001-2022-09-09</p>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures, tables)</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>1.There is a time series data:</p>
<pre><code>## 
## Attaching package: &#39;TSA&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     acf, arima</code></pre>
<pre><code>## The following object is masked from &#39;package:utils&#39;:
## 
##     tar</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(oil.price)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(oil.price), <span class="at">ylab=</span><span class="st">&#39;Price per Barrel&#39;</span>,<span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
The plots show that this time series is nonstationary,so we may consider
difference.</p>
<p>We choose the first differenc for the data, we can see that:</p>
<p><img src="data:image/png;base64,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" /><!-- -->
With first difference , it shows that this time series become more
stationary . And consider the plot of ‘eacf’ , we can choose MA(1)
model.</p>
<p>2.There is a table about the data of artists:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(trees))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Girth</th>
<th align="right">Height</th>
<th align="right">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">8.3</td>
<td align="right">70</td>
<td align="right">10.3</td>
</tr>
<tr class="even">
<td align="right">8.6</td>
<td align="right">65</td>
<td align="right">10.3</td>
</tr>
<tr class="odd">
<td align="right">8.8</td>
<td align="right">63</td>
<td align="right">10.2</td>
</tr>
<tr class="even">
<td align="right">10.5</td>
<td align="right">72</td>
<td align="right">16.4</td>
</tr>
<tr class="odd">
<td align="right">10.7</td>
<td align="right">81</td>
<td align="right">18.8</td>
</tr>
<tr class="even">
<td align="right">10.8</td>
<td align="right">83</td>
<td align="right">19.7</td>
</tr>
</tbody>
</table>
<p>3.R is a free software environment for statistical computing and
graphics. It compiles and runs on a wide variety of UNIX platforms,
Windows and macOS.</p>
<p>See the R project web page on “What is R?” for more information.</p>
<p>Sources and binaries for R and for contributed packages are available
from the Comprehensive R Archive Network (CRAN).</p>
<p>###A-22001-2022-09-15</p>
</div>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>The Pareto(a, b) distribution has cdf <span class="math display">\[F(x)=1 − (\frac{b}{x})^ a\]</span> <span class="math inline">\(x ≥ b &gt; 0,a&gt; 0\)</span>. Derive the
probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform
method to simulate a random sample from the Pareto(2, 2) distribution.
Graph the density histogram of the sample with the Pareto(2, 2) density
superimposed for comparison.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer 1</h2>
<p>We use the inverse transform method to simulate a random sample from
the Pareto(2, 2) distribution. The method can be summarized as
follows:</p>
<p>     1.We can derive the inverse function <span class="math inline">\(F_{X}^{−1}(u)=\frac{b}
{(1-u)^{\frac{1}{a}}}\)</span>.</p>
<ol start="2" style="list-style-type: decimal">
<li><p>Write a command or function to compute <span class="math inline">\(F_{X}^{−1}(u)\)</span>.</p></li>
<li><p>For each random variate required:</p></li>
</ol>
<p>  <span class="math inline">\((a)\)</span> Generate a random u from
Uniform(0,1).</p>
<p>  <span class="math inline">\((b)\)</span> Deliver <span class="math inline">\(x = F_{X}^{−1}(u)\)</span>.</p>
<p>So we can considerthe random sample x generated by the above method
follows Pareto(2, 2).</p>
<p>The codes as follow:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> b<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>a)</span></code></pre></div>
<p>Then,we graph the density histogram of the sample with the Pareto(2,
2) density superimposed for comparison:</p>
<p>We can derive the Pareto(2, 2) density function <span class="math inline">\(f(x)=8y^{-3}\)</span>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>) <span class="co">#density histogram of sample</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="dv">8</span><span class="sc">*</span>y<span class="sc">^</span>(<span class="sc">-</span><span class="dv">3</span>)) <span class="co">#density curve f(x)</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This plot shows that the sample generated by the inverse transform
method may follow the Pareto(2, 2).</p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Write a function to generate a random sample of size n from the
Beta(a, b) distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
<p>We use the acceptance-rejection method to simulate a random sample
from the Beta(a, b) distribution. The method can be summarized as
follows:</p>
<ol style="list-style-type: decimal">
<li><p>Find a random variable Y with density g satisfying f(t)/g(t) ≤ c,
for all t such that f(t) &gt; 0. Provide a method to generate random
Y.</p></li>
<li><p>For each random variate required:</p></li>
</ol>
<p> <span class="math inline">\((a)\)</span> Generate a random y from
the distribution with density g.</p>
<p> <span class="math inline">\((b)\)</span> Generate a random u from
the Uniform(0, 1) distribution.</p>
<p> <span class="math inline">\((c)\)</span> If u&lt;f(y)/(cg(y)) accept
y and deliver x = y; otherwise reject y and repeat from step (2a).</p>
<p>We know that the density function of Beta(a, b) is <span class="math inline">\(f(x)=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x^{a-1}(1-x)^{b-1}\)</span>.</p>
<p>So we choose g(x)=1 for 0&lt;x&lt;1;and for some suitable c ;cg(x)=c
can be used to generate a random sample of size n from the Beta(a, b)
distribution by the acceptance-rejection method.</p>
<p>For the Beta(3,2),the density function is <span class="math inline">\(f(x)=12x^2(1-x)\)</span>,with <span class="math inline">\(f^{&#39;}(x)=0\)</span>.We can get the <span class="math inline">\(\max f(x)=\frac{16}{9}\)</span>.</p>
<p>So we choose <span class="math inline">\(c=\frac{16}{9}\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#counter for accepted</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="dv">27</span><span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">&gt;</span> u) {</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#we accept x</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>} }</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">prob =</span> <span class="cn">TRUE</span>) <span class="co">#density histogram of sample</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">dbeta</span>(d,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d,m) <span class="co">#density curve f(x)</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We may obtain that the density histogram of sample approximately
match the theoretical density curve f(x).</p>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>Simulate a continuous Exponential-Gamma mixture. Suppose that the
rate parameter <span class="math inline">\(\Lambda\)</span> has <span class="math inline">\(Gamma(r, β)\)</span> distribution and Y has
$Exp(Λ) $distribution. That is, <span class="math inline">\((Y |Λ =
λ)\)</span> ∼ <span class="math inline">\(f_Y (y|λ)\)</span> = <span class="math inline">\(λe^{−λy}\)</span>. Generate 1000 random
observations from this mixture with r = 4 and$ β = 2$.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
<p>The codes that generate 1000 random observations from this mixture as
follow:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#generate a Exponential-Gamma mixture</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, r, beta) <span class="co">#lambda is random</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#now supply the sample of lambda’s as the Poisson mean</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="dv">1</span>,lambda) <span class="co">#the mixture</span></span></code></pre></div>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto
distribution with cdf <span class="math display">\[F(y)=1 − (\frac{ β}{β
+ y })^ r\]</span> <span class="math inline">\(y ≥ 0.\)</span> (This is
an alternative parameterization of the Pareto cdf given in Exercise
3.3.) Generate 1000 random observations from the mixture with r = 4 and
β = 2. Compare the empirical and theoretical (Pareto) distributions by
graphing the density histogram of the sample and superimposing the
Pareto density curve.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer 4</h2>
<p>We can derive that the Pareto density function <span class="math inline">\(f(x)=64(2+y)^{-5}\)</span> for r = 4 and β =
2.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#generate a Exponential-Gamma mixture</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, r, beta) <span class="co">#lambda is random</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#now supply the sample of lambda’s as the Poisson mean</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="dv">1</span>,lambda) <span class="co">#the mixture</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#compare with Pareto</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">breaks=</span><span class="dv">12</span>,<span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="fl">0.01</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d,<span class="dv">64</span><span class="sc">*</span>(<span class="dv">2</span><span class="sc">+</span>d)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">5</span>),<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The black line and density histogram is the empirical Pareto
distribution, and the red line is theoretical Pareto distribution.We may
obtain that the empirical Pareto distribution approximately match the
theoretical Pareto(4,2) distribution.</p>
<p>###A-22001-2022-09-23</p>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>For <span class="math inline">\(n = 10^4, 2 × 10^4, 4 × 10^4, 6 ×
10^4, 8 × 10^4\)</span> , apply the fast sorting algorithm to randomly
permuted numbers of 1, . . . , n. </p>
<p>• Calculate computation time averaged over 100 simulations, denoted
by <span class="math inline">\(a_n\)</span>.</p>
<p>• Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n := n log(n)\)</span>, and graphically show the
results (scatter plot and regression line).</p>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<p>We use this code Calculate computation time, and repeat 100 times for
the average time t.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))}</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">100</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a> {test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fl">1e3</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  t[i]<span class="ot">=</span><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>t1<span class="ot">=</span><span class="fu">mean</span>(t)</span></code></pre></div>
<p>By changing n in <span class="math inline">\(10^4, 2 × 10^4, 4 ×
10^4, 6 × 10^4, 8 × 10^4\)</span> ,we can calculate different <span class="math inline">\(a_n=(0.0217, 0.0450, 0.0896 ,0.1410,
0.1942)\)</span>,it increases along with n.</p>
<p>Then we regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n := n log(n)\)</span> and graph the scatter
plot and regression line:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">c</span>(<span class="fl">1e3</span>,<span class="fl">2e3</span>,<span class="fl">4e3</span>,<span class="fl">6e3</span>,<span class="fl">8e3</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">c</span>(t1,t2,t3,t4,t5)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span>n<span class="sc">*</span><span class="fu">log</span>(n)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>b0<span class="ot">=</span><span class="fu">lm</span>(t<span class="sc">~</span>a)<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>b1<span class="ot">=</span><span class="fu">lm</span>(t<span class="sc">~</span>a)<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,t)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.001</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,b0<span class="sc">+</span>b1<span class="sc">*</span>x)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAS1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmtv+QOgCQ2/+2ZgC225C2///bkDrb////tmb/25D//7b//9v///++esKWAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGd0lEQVR4nO2d62KbOBBGaTfdS9o0W6/j8P5PugsYcLLgz1gz0gif8yOxE9AoJ7oM4uKmhas0pSsQHQQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAmNBTTWUEmRbnANnNwhaodPTVRJByzTjVwQtMQ49CFqkaWhB15jclBiDts+euZlqxiy2xP//cQi6ZKFWCJpZ7PcImliuEoLOrE0bCBpYrQ+Cetarg6B2vXv1v7u5EIuauBWXxNW6IEgk9U6C3l+GA4qvv0yKc0RVxEfQoflreHEcXyQV54c+JnQR9P4yaTn89k9ycX7cUAsXQafnH+PL40onCyHolko8cAu6bcnFaww6N6HPY1Cg9aAba+A0i52eBw0r7ad8C7r5P/SgedDt4R9S0JYO/oiJ4qbYD5gobgv9cNP81vnz0RLFzXEfqwXdkX5lThTvK86Iu7LTvSeKFzn7fSF3ngfNZ9fvPbjZt6D5Go274+07URwFJUTbd6KY1rsuirDcsI00zc9jUEoJthu21xLF7OtByZF23oLS4+w8UUwPs+tE0aIj7zkPMomxX0FG88BuE0WrADtNFO3SiH1O84al73JF0bLwHbYg2yx9f4liqem2kkTR/CBvX3mQwzHwrgR5FLpd0On7z/772vzUbfLcjTzHzImizxLK/YIOQlA/f11M+EMpbutBXitMWwW9zn/iyvzUDoLOanJN826z4v0t6AqdoLdvvaA8iaLjAqVTJp23BXmm5U6Cui741I7DdWJxAt/1ba9p/j9HX36uJ9KGgrzXBcw3zFyc98JS5YL8Tx/VJ+gyh8qwsl2doItzpVnOPtYmqJm/5jy9b7mhb3GToFwnr2sVlOvUdXWCzmNQNj/1CWoz3ytUn6BsFz5sDGZ0Ijd9PSjzrWa1taDsd+JVJii3nsoElbiRsyJBZe5zrUdQET31CCp2m3QlgkrpqURQybvsaxBUUE8Vgor68RJkdxFn6YdY+Aiyu4izsB4nQWaX4JVuPq3bmVWbizjL6wndggI0n9ZvDEp/flAIPW6zWPpFnEH8RM2DYnSvjpiCwugJmShGeMDZTLxEcf7QhhCEm+ab67/OTrBE8eIjUYIQqgV9+EiUIGROFK8WN7uJ4ydQovj5I1GCECYPiiTlkiCCQjWaD8RIFMPqCZIoBvYTYZqP2706MieKC+tBofUUbkExnrx9nZKJYhO9e3UUTBSbaAfuixTMgzZ+hmAhSgryKNecYoli00Q7LF2maKIYfw4LkSjGptiKYjV4CLqhBdkFy7eHYXk6UTQMlm0Py/JkomgZLNceecszDoagAHvkLc84GIIC7GFX3jhEd6w/hskoWL49DMt7f7nLy33Bsu1hWd77y5Nx/PBsFH5sfuiNdkU1R5elQJAAQQIECRAkQJAAQQIECRAkQJAAQQJHQceme6zp5zfji/nBsPYx2vbtj19GMfwEHbuHvo4Vnt5ML95+l49nvjdGZ6Zfl7GI4SZoOIn2+vTxzfzTK4+GT4zRN6W+dIsYboKGJ3OfHwA/vZl/ejBYWVqO0Z21G9RYxPAT1Dfv8/9wejP/9PXP5trj4RNitNM3ixhugobR4DwmTG+mF6fn7uTja1rtl2P0bzpBJjFKCTpvlDZICEEmMYp1sWGjb0kruKqLWcQoNkgPG6XNwyuDdPtRUFqMUtP88OckNv+1af5csEmMYoli/5ckDqCrieI4ixnEcDzUOAyZ/3Au7TAeBkwvug+DST6HtBxjajYGMThYFSBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIEF6QyVUyCUQX1F0DdfiSdBFdGsEFnb7/TL4MM43ggjqORftYdEGHpvn6Ny1olb530cXW6S/GLPrAkOCCusZzek69ISWF4IKGS3tfC87z0QUVB0ECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJPgXtBLW5mgZbIAAAAAASUVORK5CYII=" /><!-- --></p>
<p>The figure shows that the regression line fit well with the
scatter.So we can consider that the relationship between t and n maybe
nlog(n) with something translation and scaling transformation.</p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration of <span class="math display">\[θ =
\int_{0}^{1}  e^xdx\]</span>. Now consider the antithetic variate
approach. Compute <span class="math inline">\(Cov(e^U , e^{1−U}
)\)</span> and <span class="math inline">\(Var(e^U + e^{1−U} )\)</span>,
where U ∼ Uniform(0,1). What is the percent reduction in variance of
<span class="math inline">\(\hat{θ}\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</p>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<p>We can calculate as follows ：</p>
<p>For U~U(0,1)</p>
<p><span class="math inline">\(E(e^U)=E(e^{1-U})=\int_{0}^{1}
e^xdx=e-1\)</span></p>
<p><span class="math inline">\(E(e^{2U})=E(e^{2(1-U)})=\int_{0}^{1}
e^{2x}dx=\frac{e^2-1}{2}\)</span></p>
<p><span class="math inline">\(Var(e^U)=Var(e^{1-U})=E(e^{2U})-(E(e^U))^2=\frac{e^2-1}{2}-(e-1)^2=0.2420356\)</span></p>
<p>So <span class="math display">\[Cov(e^U ,
e^{1−U})=E(e^Ue^{1-U})-E(e^U)E(e^{1-U})=e-(e-1)^2=-0.2342106\]</span></p>
<p><span class="math display">\[Var(e^U + e^{1−U}
)=Var(e^U)+Var(e^{1-U})+2Cov(e^U , e^{1−U})=0.01564999\]</span> Then we
assume <span class="math inline">\(\hat{\theta}=\frac{e^U +
e^{V}}{2}\)</span> ,and U 、V are independent.</p>
<p><span class="math display">\[Var(\hat{\theta})=Var(e^U)/2=\frac{e^2-1}{4}-\frac{(e-1)^2}{2}=0.1210178\]</span>
Then use the antithetic variate <span class="math inline">\(\hat{\theta}_{an}=\frac{e^U +
e^{1-U}}{2}\)</span></p>
<p><span class="math display">\[Var(\hat{\theta}_{an})=Var(e^U +
e^{1−U})/4=0.003912497\]</span> So the percent of reduction:</p>
<p><span class="math display">\[\frac{Var(\hat{\theta})-Var(\hat{\theta}_{an})}{Var(\hat{\theta})}=0.9676701\]</span></p>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate θ by
the antithetic variate approach and by the simple Monte Carlo method.
Compute an empirical estimate of the percent reduction in variance using
the antithetic variate. Compare the result with the theoretical value
from Exercise 5.6.</p>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>u1<span class="ot">=</span><span class="fu">runif</span>(n)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>u2<span class="ot">=</span><span class="fu">runif</span>(n)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>u3<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>u1</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>t1<span class="ot">=</span>(<span class="fu">mean</span>(<span class="fu">exp</span>(u1))<span class="sc">+</span><span class="fu">mean</span>(<span class="fu">exp</span>(u2)))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>t2<span class="ot">=</span>(<span class="fu">mean</span>(<span class="fu">exp</span>(u1))<span class="sc">+</span><span class="fu">mean</span>(<span class="fu">exp</span>(u3)))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>se1<span class="ot">=</span><span class="fu">sd</span>((<span class="fu">exp</span>(u1)<span class="sc">+</span><span class="fu">exp</span>(u2))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>se2<span class="ot">=</span><span class="fu">sd</span>((<span class="fu">exp</span>(u1)<span class="sc">+</span><span class="fu">exp</span>(u3))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span>(se1<span class="sc">^</span><span class="dv">2</span><span class="sc">-</span>se2<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>se1<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.9662576</code></pre>
<p>So we compute an empirical estimate of the percent reduction in
variance using the antithetic variate is p=0.9678386. Comparing with the
result in 5.6 p=0.9676701. They are quite close.</p>
<p>###A-22001-2022-09-30</p>
</div>
<div id="exercise-5.13" class="section level2">
<h2>Exercise 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, ∞)\)</span> and are ‘close’ to</p>
<p><span class="math display">\[
g(x) =\frac{x^2}{\sqrt{2\pi}}e^{−x^{2}/2}, x&gt;1.
\]</span> Which of your two importance functions should produce the
smaller variance in estimating</p>
<p><span class="math display">\[
\int_{1}^{\infty} \frac{x^2}{\sqrt{2\pi} }e^{−x^2/2}dx
\]</span> by importance sampling? Explain.</p>
<p><strong>Solution.</strong></p>
<p>·Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, ∞)\)</span> and are ‘close’ to g(x).</p>
<p>Here we can consider <span class="math inline">\(f_1\)</span>、<span class="math inline">\(f_2\)</span> follows some truncated Normal
distribution and shifted F distribution which are supported on x &gt;
1.</p>
<p>So we choose <span class="math display">\[f_1(x)=\frac{e^{−(x-1)^2/2}}{\sqrt{2\pi}
}/\int_{1}^{\infty}\frac{e^{−(x-1)^2/2}}{\sqrt{2\pi}
}=2\frac{e^{−(x-1)^2/2}}{\sqrt{2\pi} } ,x&gt;1.\]</span> It means we
have a truncated Normal distribution ,i.e. <span class="math inline">\(X_1\)</span>~<span class="math inline">\(N(1,1)\)</span> on <span class="math inline">\(x_1&gt;1\)</span>.</p>
<p>Then we choose <span class="math display">\[
\begin{aligned}
f_2(x)&amp;=\frac{\Gamma((4+4)/2)}{\Gamma(4/2)\Gamma(4/2)}(\frac{4}{4})^{\frac{4}{2}}(x-1)^{\frac{4}{2}-1}(1+\frac{4}{4}(x-1))^{-\frac{4+4}{2}}\\
&amp;=18(x-1)x^{-4}
\end{aligned}
\]</span> It means if <span class="math inline">\(X_2\)</span>~<span class="math inline">\(f_2\)</span> we have <span class="math inline">\((X_2-1)\)</span>~<span class="math inline">\(F(4,4)\)</span></p>
<p>Both are satisfied the conditions that the support set is (1, ∞).</p>
<p>We graph g(x)、<span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> so that we can compare them
directly.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a> x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a> y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">lines</span>(x, <span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x, <span class="dv">1</span>,<span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>)<span class="co">#Truncated Normal distribution</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">lines</span>(x, <span class="fu">df</span>(x <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">4</span>), <span class="at">lty =</span> <span class="dv">3</span>)<span class="co">#shifted F distribution</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">inset =</span> <span class="fl">0.03</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g(x)&quot;</span>, <span class="st">&quot;f_1&quot;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;f_2&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As is shown above, <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> seem both are ‘close’ to g(x).</p>
<p>Because variance of importance sampling <span class="math inline">\(\hat{θ}\)</span> is <span class="math inline">\(var(g(X_1)/f (X_1))/m\)</span>, which has the
minimal value 0 when g(·) = cf (·) for some constant c.</p>
<p>Then Compare the ratios g(x)/f(x).The plot showed as follows:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x, <span class="dv">1</span>,<span class="dv">1</span>)), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a> <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">lines</span>(x, y<span class="sc">/</span><span class="fu">df</span>(x <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">4</span>), <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">inset =</span> <span class="fl">0.03</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;f_1&quot;</span>, <span class="st">&quot;f_2&quot;</span>),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a> <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The plot shows that the ratio g(x)/f(x) of truncated normal
importance function is closer to a constant function than the shifted F
distribution . So we may consider the truncated normal importance
function as it can produce the smaller variance in estimating the
integral .</p>
</div>
<div id="exercise-5.15" class="section level2">
<h2>Exercise 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
<p><strong><em>Example 5.13 (Example 5.10, cont.)</em></strong></p>
<p>In Example 5.10 our best result was obtained with importance function
<span class="math inline">\(f_3(x) =e^{−x}/(1 − e^{−1}), 0 &lt;x&lt;
1.\)</span> From 10000 replicates we obtained the estimate <span class="math inline">\(\hat{θ}\)</span> = 0.5257801 and an estimated
standard error 0.0970314.</p>
<p>Now divide the interval (0,1) into five subintervals, (j/5,(j +
1)/5), j = 0, 1,…, 4. Then on the jth subinterval variables are
generated from the density <span class="math display">\[f_{j}(x)=\frac{5e^{−x}}{ 1 − e^{−1}} , \frac{j −
1}{ 5} &lt;x&lt; \frac{j}{5}.\]</span> (There is something wrong with
this subintervals.) So we just modify it’s subintervals slightly as
follows:</p>
<p><span class="math display">\[f_{j}(x)=\frac{5e^{−x}}{ 1 − e^{−1}} ,
a_{j-1} &lt;x&lt; a_{j}.\]</span> Where <span class="math inline">\(a_j=F^{-1}(\frac{j}{k})\)</span></p>
<p><span class="math display">\[F(x)=\int_{0}^{x}f(x)dx=\frac{1-e^{-x}}{1-e^{-1}}\]</span></p>
<p>Then <span class="math display">\[a_{j}=F^{-1}(\frac{j}{k})=-log(1-\frac{j}{k}(1-e^{-1}))\]</span>
<strong>Solution.</strong></p>
<p>Our aim is to estimate <span class="math inline">\(\int _{0}^{1}
e^{−t}/(1 + t^2)dt\)</span>.</p>
<p>The integration with simple importance sampling can be written as:
<span class="math display">\[
\begin{aligned}
\int_0^1 e^{−t}/(1 + t^2)dt&amp; =
\sum\limits_{i=1}^{k}\int_{(i-1)/k}^{i/k}e^{−t}/(1 + t^2)dt\\
&amp;=\frac{1}{k} \sum\limits_{i=1}^{k}\int_{(i-1)/k}^{i/k}ke^{−t}/(1 +
t^2)dt\\
&amp;= \frac{1}{k}\sum\limits_{i=1}^{k}E(e^{−X_{i}}/(1 + X_{i}^2)) \\
&amp;=\frac{1}{k}\sum\limits_{i=1}^{k}E(g_{i}(X))\\
where X ∼ U((i − 1)/k, i/k).
\end{aligned}
\]</span> with importance function <span class="math display">\[f(x) =
e^{−x}/( 1 − e^{−1}) , 0 &lt;x&lt; 1,\]</span> on five subintervals,
(a_{j-1} , a_{j}), j = 0, 1,…, 4. On the jth subinterval <span class="math display">\[f_{j}(x)=\frac{5e^{−x}}{ 1 − e^{−1}} , a_{j-1}
&lt;x&lt; a_{j}.\]</span></p>
<p>Where <span class="math display">\[a_{j}=F^{-1}(\frac{j}{k})=-log(1-\frac{j}{k}(1-e^{-1}))\]</span>
Then we have the stratified inportance sampling:</p>
<span class="math display">\[\begin{aligned}
\int_0^1 e^{−t}/(1 + t^2)dt
&amp;=\frac{1}{k}\sum\limits_{i=1}^{k}E(g_{i}(X))\\
&amp;=\frac{1}{k}\sum\limits_{i=1}^{k}E(g_{i}(X)/f_{i}(x))\\
where X ∼ f_{i}(x).
\end{aligned}\]</span>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a> k <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a> m <span class="ot">&lt;-</span> n<span class="sc">/</span>k</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a> t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a> va <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a> g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a> f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) k<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a> u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, (j<span class="dv">-1</span>)<span class="sc">/</span>k, j<span class="sc">/</span>k)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a> x<span class="ot">&lt;-</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>u)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a> gf <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a> t[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(gf)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a> va[j] <span class="ot">&lt;-</span> <span class="fu">var</span>(gf)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a> }</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(t)</span></code></pre></div>
<pre><code>## [1] 0.5242093</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(va)</span></code></pre></div>
<pre><code>## [1] 1.836155e-05</code></pre>
<p>Without stratification :</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">234</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a> k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a> m <span class="ot">&lt;-</span> n<span class="sc">/</span>k</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a> t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a> va <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a> g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a> f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (<span class="dv">1</span><span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span>k) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>j<span class="sc">/</span>k))) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a> u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, (j <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>k, j<span class="sc">/</span>k)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a> x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span>k) <span class="sc">-</span> ((<span class="fu">exp</span>(<span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span>k) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>j<span class="sc">/</span>k))) <span class="sc">*</span> u)<span class="co">#the inverse transform method</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a> gf <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a> t[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(gf)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a> va[j] <span class="ot">&lt;-</span> <span class="fu">var</span>(gf)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a> }</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(t)</span></code></pre></div>
<pre><code>## [1] 0.5290944</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(va)</span></code></pre></div>
<pre><code>## [1] 0.008792394</code></pre>
<p>Comparing with the two mathods above, we can conclude that the
estimate <span class="math inline">\(\hat{θ}_{sub}\)</span> = 0.5247828
and <span class="math inline">\(\hat{θ}\)</span>=0.5247008 they are
quite closed .And without stratification we have a larger variance
0.009340412. And when we use stratification ,it makes variance extremly
reduced: 1.72156e-05.</p>
<p>###A-22001-2022-10-09</p>
<div id="exercise-6.4" class="section level3">
<h3>Exercise 6.4</h3>
<p>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a
random sample from a from a lognormal distribution with unknown
parameters. Construct a 95% confidence interval for the parameter µ. Use
a Monte Carlo method to obtain an empirical estimate of the confidence
level.</p>
<p><strong>Solution.</strong></p>
<p>Since <span class="math inline">\(X_1,...,X_n\)</span> are a random
sample from a from a lognormal distributiony.</p>
<p>We have <span class="math inline">\(X=e^{Y}\)</span>~<span class="math inline">\(LN(\mu,\sigma^{2})\)</span>,where <span class="math inline">\(Y\)</span>~<span class="math inline">\(N(\mu,\sigma^2)\)</span>.</p>
<p>so we can construct the confidence interval for the parameter µ
follow these steps:</p>
<p>1.Generate random sample <span class="math inline">\(X_1,...,X_n\)</span> following lognormal
distributiony</p>
<p>2.Calculate <span class="math inline">\(Y_1,...,Y_n\)</span>,where
<span class="math inline">\(Y_i=log(X_i)\)</span>and <span class="math inline">\(Y_i\)</span>~<span class="math inline">\(N(\mu,\sigma^2)\)</span>.</p>
<p>3.Use Y and normal distribution to construct the confidence interval
for the parameter µ :</p>
<p><span class="math display">\[[\bar{Y}-\sqrt{\frac{se^{2}}{n}}z_{\alpha/2},\bar{Y}+\sqrt{\frac{se^{2}}{n}}z_{\alpha/2}]\]</span></p>
<p>4.Repeat m times ,we can obtain an empirical estimate of the
confidence level.</p>
<p>We assume <span class="math inline">\(\mu=0\)</span>,<span class="math inline">\(\sigma^2=1\)</span>,then the code can be written
as follows:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>CIL<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>CIU<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rlnorm</span>(n)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">=</span><span class="fu">log</span>(x)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  ybar<span class="ot">=</span><span class="fu">mean</span>(y)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  se<span class="ot">=</span><span class="fu">sd</span>(y)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span>se<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  CIL[i]<span class="ot">=</span>ybar<span class="sc">+</span>s<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.025</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  CIU[i]<span class="ot">=</span>ybar<span class="sc">+</span>s<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="dv">0</span><span class="sc">&gt;=</span>CIL <span class="sc">&amp;</span> <span class="dv">0</span><span class="sc">&lt;=</span>CIU)</span></code></pre></div>
<pre><code>## [1] 0.965</code></pre>
<p>This result is very close to 0.95.</p>
</div>
<div id="exercise-6.8" class="section level3">
<h3>Exercise 6.8</h3>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F
test of equal variance, at significance level <span class="math inline">\(\hat{α}\)</span> . = 0.055. Compare the power of
the Count Five test and F test for small, medium, and large sample
sizes. (Recall that the F test is not applicable for non-normal
distributions.)</p>
<p><strong><em>Example 6.16 </em></strong></p>
<p>Example 6.16 (Count Five, cont.) Use Monte Carlo methods to estimate
the power of the Count Five test, where the sampled distributions are
<span class="math inline">\(N(µ_1 = 0, σ^{2}_1 = 1)\)</span>, <span class="math inline">\(N(µ_2 = 0, σ^2_2 = 1.52)\)</span>, and the sample
sizes are <span class="math inline">\(n_1 = n_2 = 20\)</span>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">#generate samples under H1 to estimate power</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma1)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma2)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="fu">count5test</span>(x, y)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>}))</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power)</span></code></pre></div>
<pre><code>## [1] 0.32</code></pre>
<p><strong>Solution.</strong></p>
<p>We need to Compare the power of the Count Five test and F test for
small, medium, and large sample sizes. (Recall that the F test is not
applicable for non-normal distributions.)</p>
<p>So we choose different n=20,50,100,500,1000 for comparing.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co">#generate samples under H1 to estimate power</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span></code></pre></div>
<p>The code of Count Five test:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>c5<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)){</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a> power <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a> x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a> y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">count5test</span>(x, y)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a> }))</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(power)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a> }</span></code></pre></div>
<pre><code>## [1] 0.32
## [1] 0.687
## [1] 0.841
## [1] 0.993
## [1] 0.999</code></pre>
<p>The code of F test:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>c5<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)){</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a> Ftest <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a> x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a> y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a> Fp <span class="ot">&lt;-</span> <span class="fu">var.test</span>(x, y)<span class="sc">$</span>p.value</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a> f <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(Fp <span class="sc">&lt;=</span> <span class="fl">0.055</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a> }))</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(Ftest)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<pre><code>## [1] 0.439
## [1] 0.819
## [1] 0.975
## [1] 1
## [1] 1</code></pre>
<p>It can be seen that the F-test for equal variance is more powerful as
it’s power is higher than the Count Five test in each cases of different
sample sizes. And for the F-test ,the power is approching 1 more
quickly.</p>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. Can we say the powers are different at 0.05 level?</p>
<p>• What is the corresponding hypothesis test problem?</p>
<p>• Which test can we use? Z-test, two-sample t-test, paired-t test or
McNemar test? Why?</p>
<p>• Please provide the least necessary information for hypothesis
testing.</p>
<p><strong>Solution.</strong> •We Conside the hypothesis test
problem:</p>
<p><span class="math display">\[H_0:p_1=p_2 \leftrightarrow H_1:p_1\neq
p_2\]</span> •We may consider Z-test and McNemar test.</p>
<p>For the Z-test:we consider each experiments are independent ,so the
normal approximation could be chosen.</p>
<p>For the McNemar test: it’s a nonparamatric methods in the homogeneity
test when we have no more information about the distribution.</p>
<p>• We consider the Z-test first:</p>
<p>For <span class="math display">\[n_1\bar{X}\sim
B(n_1,p_1),n_2\bar{Y}\sim B(n_2,p_2)\]</span></p>
<p>Consider the large sample approximation, we have:</p>
<p><span class="math display">\[\bar{X}\sim
(p_1,\frac{p_1(1-p_1)}{n_1}),\bar{Y}\sim
(p_2,\frac{p_2(1-p_2)}{n_2})\]</span></p>
<p>Under the null hypothesis, we have <span class="math inline">\(p_1=p_2=p\)</span></p>
<p>And we use the frequency <span class="math inline">\(\hat{p}=\frac{n_1\bar{X}+n_2\bar{Y}}{n_1+n_2}\)</span></p>
<p>then when the sample large enough:</p>
<p><span class="math display">\[U=\frac{\bar{X}-\bar{Y}}{\sqrt{\hat{p}(1-\hat{p})}\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}}\sim
N(0,1)\]</span> Then since this question <span class="math inline">\(n_1=n_2=10000\)</span>,<span class="math inline">\(\bar{X}=0.651\)</span>,<span class="math inline">\(\bar{Y}=0.676\)</span>,<span class="math inline">\(\hat{p}=(651+676)/20000=0.6635\)</span></p>
<p>Caculate u:</p>
<p><span class="math display">\[u=\frac{0.676-0.651}{\sqrt(0.6635(1-0.6635))\sqrt{2/10000}}\]</span></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span>(<span class="fl">0.676-0.651</span>)<span class="sc">/</span><span class="fu">sqrt</span>((<span class="fl">0.6635</span><span class="sc">*</span>(<span class="dv">1</span><span class="fl">-0.6635</span>)))<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">10000</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>u</span></code></pre></div>
<pre><code>## [1] 3.741209</code></pre>
<p>since <span class="math inline">\(\alpha=0.05\)</span>,<span class="math inline">\(u_{\alpha/2}=1.96\)</span>,<span class="math inline">\(u=3.74&gt;1.96\)</span>,so we may reject the null
hypothesis,and consider <span class="math inline">\(p_1\neq
p_2\)</span></p>
<p>Then consider the McNemar test:</p>
<p>It can be seen that the contingency table is not complete ,so we
simulate the result to construct the test statistics:</p>
<p><span class="math display">\[T=\frac{(x_2-y_1)^2}{(x_2+y_1)}\sim_{H_0}\mathcal{X}(1)\]</span>
we couldn’t calculate <span class="math inline">\(x_2\)</span>,<span class="math inline">\(y_1\)</span> in this problem,we just have the
equation：</p>
<p><span class="math display">\[x_1+x_2=676\]</span> <span class="math display">\[x_1+y_1=651\]</span> then we just simulate the
result:</p>
<p>since <span class="math inline">\(\mathcal{X}_{0.05}(1)=3.84\)</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">651</span>,<span class="dv">100000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">=</span><span class="dv">676</span><span class="sc">-</span>x1</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">=</span><span class="dv">651</span><span class="sc">-</span>x1</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(x2<span class="sc">-</span>y1)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(x2<span class="sc">+</span>y1)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z)<span class="co">#&lt;3.84 </span></span></code></pre></div>
<pre><code>## [1] 1.924013</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z<span class="sc">&gt;</span><span class="fl">3.84</span>)</span></code></pre></div>
<pre><code>## [1] 0.10546</code></pre>
<p>the result is not reject the null hypothesis by this method,we may
consider <span class="math inline">\(p_1=p_2\)</span>.</p>
<p>It can be found that differnt methods make differnet results .But in
my opinion ,I think the Z-test may be more suitable for this problem
,because the infomation for Z-test is quite complete while we may choose
simulation in McNemar test, it may result in something wrong.<br />
###A-22001-2022-10-14</p>
</div>
<div id="exercise-7.4" class="section level3">
<h3>Exercise 7.4</h3>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package. The 12 observations are the times in hours between failures of
airconditioning equipment [63, Example 1.1]:</p>
<p>3, 5, 7, 18, 43, 85, 91, 98, 100, 130, 230, 487.</p>
<p>Assume that the times between failures follow an exponential model
Exp(λ). Obtain the MLE of the hazard rate λ and use bootstrap to
estimate the bias and standard error of the estimate.</p>
<p><strong>Solution.</strong></p>
<p>Since <span class="math inline">\(X_1,...,X_12\)</span> are follow an
exponential model Exp(λ).</p>
<p>We use MLE to obtain <span class="math inline">\(\lambda\)</span>,the
likelihood function:</p>
<p><span class="math display">\[L(\lambda)=\lambda^{n}e^{-\sum_{i=1}^nX_i\lambda}\]</span></p>
<p>the logarithmic likelihood function：</p>
<p><span class="math display">\[l(\lambda)=nlog\lambda-\sum_{i=1}^nX_i\lambda\]</span></p>
<p><span class="math display">\[\frac{dl(\lambda)}{d\lambda}=\frac{n}{\lambda}-\sum_{i=1}^nX_i=0\]</span>
Obtain the MLE of <span class="math inline">\(\lambda\)</span>:</p>
<p><span class="math display">\[\hat{\lambda}=\frac{n}{\sum_{i=1}^nX_i}=\frac{1}{\bar{X}}\]</span></p>
<p>Then we use bootstrap to estimate the bias and standard error of the
estimate.The code and result are shown as follow:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x);</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e4</span>; <span class="fu">set.seed</span>(<span class="dv">12345</span>);lambdastar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>xstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>lambdastar[b] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>lambda<span class="co">#original statistic</span></span></code></pre></div>
<pre><code>## [1] 0.00925212</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(lambdastar)<span class="sc">-</span>lambda<span class="co"># the bias</span></span></code></pre></div>
<pre><code>## [1] 0.00131529</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(lambdastar)<span class="co">#bootstrap standard error</span></span></code></pre></div>
<pre><code>## [1] 0.004292739</code></pre>
</div>
<div id="exercise-7.5" class="section level3">
<h3>Exercise 7.5</h3>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<p><strong>Solution.</strong></p>
<p>For the estimate of <span class="math inline">\(\frac{1}{\lambda}\)</span>:</p>
<p><span class="math display">\[\hat{\theta}=\frac{1}{\hat{\lambda}}=\bar{x}\]</span></p>
<p>We can use the R-package ‘boot’ to calculate the confidence intervals
by the standard normal, basic, percentile, and BCa methods;the result
shows as follows:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">boot</span>(x, <span class="at">statistic =</span> boot.mean, <span class="at">R =</span> <span class="dv">3000</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>r</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = x, statistic = boot.mean, R = 3000)
## 
## 
## Bootstrap Statistics :
##     original      bias    std. error
## t1* 108.0833 -0.06394444    38.21252</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(r, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 3000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = r, type = c(&quot;norm&quot;, &quot;perc&quot;, &quot;basic&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 33.3, 183.0 )   ( 23.6, 171.7 )  
## 
## Level     Percentile            BCa          
## 95%   ( 44.4, 192.6 )   ( 55.9, 226.4 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>We can also graph the histogram of <span class="math inline">\(\hat{\theta}\)</span>:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(r<span class="sc">$</span>t, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>r<span class="sc">$</span>t0,<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can be noted that the 95% confidence interval: Normal method is (
33.3, 183.0 ); Basic method is ( 23.6, 171.7 ) ;Percentile method is (
44.4, 192.6 ) ;BCa method is ( 55.9, 226.4 )</p>
<p>The histogram are showed that <span class="math inline">\(\hat{\theta}\)</span> may not approximately normal
, so the normal and percentile intervals differ. And the histogram also
has displayed that it’s a right-skewed distribution, so we just use a
small size sample that we could not give a good approximation when we
choose CLT .</p>
</div>
<div id="exercise-7.a" class="section level3">
<h3>Exercise 7.A</h3>
<p>Conduct a Monte Carlo study to estimate the coverage probabilities of
the standard normal bootstrap confidence interval, the basic bootstrap
confidence interval, and the percentile confidence interval. Sample from
a normal population and check the empirical coverage rates for the
sample mean. Find the proportion of times that the confidence intervals
miss on the left, and the porportion of times that the confidence
intervals miss on the right.</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="dv">0</span>;b<span class="ot">&lt;-</span><span class="dv">1</span>;n<span class="ot">&lt;-</span><span class="dv">500</span>;m<span class="ot">&lt;-</span><span class="fl">1e3</span>;<span class="fu">library</span>(boot);<span class="fu">set.seed</span>(<span class="dv">435</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>);</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>R,<span class="at">statistic=</span>boot.mean, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The standard normal bootstrap confidence interval:</p>
<p><span class="math display">\[( \hat{ θ} − z_{1−α/2} \hat{ se}( \hat
θ), \hatθ − z_{α/2} \hat{ se}( \hat θ))\]</span> so we can calculate the
empirical coverage rates:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu)</span></code></pre></div>
<pre><code>## [1] 0.956</code></pre>
<p>the basic bootstrap confidence interval： The (1 − α)-CI of θ
is：</p>
<p><span class="math display">\[( \hatθ − F^{−1} (1 − α/2), \hat θ −
F^{−1} (α/2))\]</span> <span class="math inline">\(F^{−1} (1 −
α/2)\)</span> and <span class="math inline">\(F^{ −1} (α/2)\)</span> can
be approximated by the (1 − α/2)- and (α/2)-quantiles of <span class="math inline">\(\hatθ ^{∗} − \hat θ\)</span>:<span class="math inline">\(\hatθ^{∗}_{1−α/2} −\hatθ\)</span> and<span class="math inline">\(\hatθ^{∗}_{α/2} −\hatθ\)</span>:</p>
<p>The resulting (1 − α)-CI is</p>
<p><span class="math display">\[(2 \hatθ − \hat{θ}^{∗}_{1−α/2} ,2 \hatθ
− \hatθ^{∗}_{α/2} )\]</span> the empirical coverage rates：</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu)</span></code></pre></div>
<pre><code>## [1] 0.954</code></pre>
<p>The percentile confidence interval: <span class="math display">\[(
\hat θ^{*}_{α/2} ,\hatθ^∗_{1−α/2} )\]</span> the empirical coverage
rates：</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu)</span></code></pre></div>
<pre><code>## [1] 0.955</code></pre>
<p>###A-22001-2022-10-21</p>
</div>
<div id="exercise-7.8" class="section level3">
<h3>Exercise 7.8</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hatθ\)</span>.</p>
<p><strong>Exercise 7.7</strong></p>
<p>Refer to Exercise 7.6. Efron and Tibshirani discuss the following
example [84, Ch. 7]. The five-dimensional scores data have a 5 × 5
covariance matrix Σ, with positive eigenvalues <span class="math inline">\(λ_1 &gt; ··· &gt; λ_5\)</span>. In principal
components analysis, <span class="math display">\[θ =
\frac{\lambda_{1}}{\sum\limits_{i=1}^{5}\lambda_{i}}\]</span> measures
the proportion of variance explained by the first principal component.
Let <span class="math inline">\(\hatλ_1 &gt; ··· &gt; \hatλ_5\)</span>
be the eigenvalues of <span class="math inline">\(\hatΣ\)</span>, where
ˆ Σ is the MLE of Σ. Compute the sample estimate <span class="math display">\[\hatθ =
\frac{\hat\lambda_{1}}{\sum\limits_{i=1}^{5}\hat\lambda_{i}}\]</span></p>
<p><strong>Solution.</strong></p>
<p>Then we use jackknife to estimate the bias and standard error of the
estimate.The code and result are shown as follow:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(bootstrap)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a> s <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(scor)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(s)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a> theta <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a> m<span class="ot">=</span><span class="fu">cov</span>(s)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a> lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(m)<span class="sc">$</span>values</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a> theta.hat <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda)<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a> y <span class="ot">&lt;-</span> s[<span class="sc">-</span>i, ]</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a> x <span class="ot">&lt;-</span> <span class="fu">cov</span>(y)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a> lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(x)<span class="sc">$</span>values</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a> theta[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda)<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a> bias <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta) <span class="sc">-</span> theta.hat)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a> se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">mean</span>((theta <span class="sc">-</span> <span class="fu">mean</span>(theta))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a> bias</span></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a> se</span></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
<p>So it can be noted that we use jackknife to estimate the bias
0.001069139,standard error is 0.04955231.</p>
</div>
<div id="exercise-7.11" class="section level3">
<h3>Exercise 7.11</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
<p><strong>Solution.</strong> We choose leave-two-out cross validation
to select the best fitting model from:</p>
<p><span class="math display">\[Linear: Y = β_0 + β_1 X +
\epsilon\]</span></p>
<p><span class="math display">\[Quadratic: Y = β_0 + β_1 X + β_2 X^2 +
\epsilon\]</span></p>
<p><span class="math display">\[Exponential: log(Y) = β_ 0 + β_1 X +
\epsilon\]</span></p>
<p><span class="math display">\[Log-log: log(Y) = β_0 + β_1 log(X) +
\epsilon\]</span></p>
<p>Comparing the leave-two-out cross validation with leave-one-out cross
validation, the leave-two-out method shown as follows</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG, <span class="at">warn.conflict =</span> <span class="cn">FALSE</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">attach</span>(ironslag)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">length</span>(chemical)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a> N <span class="ot">&lt;-</span> <span class="fu">choose</span>(n, <span class="dv">2</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a> e1 <span class="ot">&lt;-</span>  <span class="fu">numeric</span>(N)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a> m <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n) </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>       k <span class="ot">&lt;-</span> <span class="fu">c</span>(i, j)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>       y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>       x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>       M1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>       y.h1 <span class="ot">&lt;-</span> M1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> M1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>       e1[m] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> y.h1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>       m<span class="ot">=</span>m<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">mean</span>(e1)</span></code></pre></div>
<pre><code>## [1] 39.14455</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">length</span>(chemical)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a> N <span class="ot">&lt;-</span> <span class="fu">choose</span>(n, <span class="dv">2</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a> e2 <span class="ot">&lt;-</span>  <span class="fu">numeric</span>(N)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a> m <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) </span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n) </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>     {</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> <span class="fu">c</span>(i, j)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>      M2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>      y.h2 <span class="ot">&lt;-</span> M2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> M2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>      M2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>      e2[m] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> y.h2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>      m<span class="ot">=</span>m<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a> <span class="fu">mean</span>(e2)</span></code></pre></div>
<pre><code>## [1] 35.74037</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">length</span>(chemical)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a> N <span class="ot">&lt;-</span> <span class="fu">choose</span>(n, <span class="dv">2</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a> e3 <span class="ot">&lt;-</span>  <span class="fu">numeric</span>(N)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a> m <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n) </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>     {</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>       k <span class="ot">&lt;-</span> <span class="fu">c</span>(i, j)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>       y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>       x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>       M3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>       logy.h3 <span class="ot">&lt;-</span> M3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> M3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>       y.h3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logy.h3)</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>       e3[m] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> y.h3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>       m<span class="ot">=</span>m<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a> <span class="fu">mean</span>(e3)</span></code></pre></div>
<pre><code>## [1] 36.90983</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">length</span>(chemical)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a> N <span class="ot">&lt;-</span> <span class="fu">choose</span>(n, <span class="dv">2</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a> e4 <span class="ot">&lt;-</span>  <span class="fu">numeric</span>(N)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a> m <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n) </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>     {</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>       k <span class="ot">&lt;-</span> <span class="fu">c</span>(i, j)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>       y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>       x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>       M4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>       logy.h4 <span class="ot">&lt;-</span> M4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> M4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">log</span>(chemical[k])</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>       y.h4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logy.h4)</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>       e4[m] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> y.h4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>       m<span class="ot">=</span>m<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a> <span class="fu">mean</span>(e4)</span></code></pre></div>
<pre><code>## [1] 40.93436</code></pre>
<p>in example 7.18 we use leave-one-out (n-fold) cross validation ,which
has calculated the average squared prediction error:<span class="math inline">\(e_1=19.6,e_2=17.9,e_3=18.4,e_4=20.4\)</span>So,we
choose the Quadratic Model ,as it’s average squared prediction error is
smallest</p>
<p>Then we use leave-two-out (n-fold) cross validation to calculated the
average squared prediction error:<span class="math inline">\(e_1=39.14455,e_2=35.74037,e_3=36.90983,e_4=40.93436\)</span>So,we
choose the Quadratic Model too ,as it also has a smallest average
squared prediction error.</p>
</div>
<div id="exercise-8.2" class="section level3">
<h3>Exercise 8.2</h3>
<p>Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function cor with method =
“spearman”. Compare the achieved significance level of the permutation
test with the p-value reported by cor.test on the same samples.</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>p.spear<span class="ot">&lt;-</span><span class="cf">function</span>(x,y)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  test<span class="ot">&lt;-</span><span class="fu">cor.test</span>(x,y,<span class="at">method=</span><span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">length</span>(x)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  retest<span class="ot">&lt;-</span><span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>                               k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">cor.test</span>(x[k], y, <span class="at">method =</span>                                <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>estimate</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>                                })</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">c</span>(test<span class="sc">$</span>estimate, retest)</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(test<span class="sc">$</span>estimate <span class="sc">&lt;=</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    b))</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">rho.s =</span> test<span class="sc">$</span>estimate, <span class="at">p.value =</span> p))</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we may compare the achieved significance level of the
permutation test with the p-value reported by cor.test on the same
samples from the Multinormal distribution,where the true <span class="math inline">\(corr(X_1,X_2)=0.6\)</span></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a> mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a> Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a> R <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a> x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, mu, Sigma)</span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x[, <span class="dv">1</span>], x[, <span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  x[, 1] and x[, 2]
## S = 8704, p-value = 1.368e-05
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.5820408</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.spear</span>(x[, <span class="dv">1</span>], x[, <span class="dv">2</span>])</span></code></pre></div>
<pre><code>## $rho.s
##       rho 
## 0.5820408 
## 
## $p.value
## [1] 0.001996008</code></pre>
<p>The result shows that the correlation <span class="math inline">\(\rho\)</span> estimated by spearman method is
0.5820408 which is quite close to 0.6.And p-value calculated by cor.test
is 1.368e-05 while by the permutation test is 0.001996008,though the
p-value are quite different,both of them may be considered to reject the
null hypothesis then the correlation is not significant.</p>
<p>###A-22001-2022-10-28</p>
</div>
<div id="exercise-9.4" class="section level3">
<h3>Exercise 9.4</h3>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
<p>Then use the Gelman-Rubin method to monitor convergence of the chain,
and run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat{R} &lt;
1.2\)</span>.</p>
<p><strong>Solution.</strong> The standard Laplace distribution has
density <span class="math display">\[f(x) = \frac{1}{2} e^{−|x|}, x ∈
R\]</span></p>
<p>The proposal distribution follows <span class="math inline">\(N(\mu,\sigma^2)\)</span></p>
<p>For the Metropolis sampler: g(r|s) = g(s|r) so that,<span class="math display">\[α(r,s) = min \{f (s)/f
(r),1\}=min\{e^{|r|-|s|},1\}\]</span></p>
<p>Generating the standard Laplace distribution:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    f<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>      d<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(d)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma, x0, N) {</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>        x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>        u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>            y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">f</span>(y) <span class="sc">/</span> <span class="fu">f</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>                    x[i] <span class="ot">&lt;-</span> y  </span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> {</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>                    x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>                    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">4</span>  <span class="co">#degrees of freedom for target Student t dist.</span></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>    sigma <span class="ot">&lt;-</span> <span class="fu">c</span>( .<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>    rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>    rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>    rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>    rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, sigma[<span class="dv">4</span>], x0, N)</span></code></pre></div>
<p>The acceptance rates of each chain and graph the chain：</p>
<p>the Gelman-Rubin method:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for chain in i-th row of X</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>        psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>        psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>        psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>        W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>        v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>        r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(r.hat)</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<p>Use the Gelman-Rubin method to monitor convergence of the chain:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)     <span class="co">#parameter of proposal distribution</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">4</span>          <span class="co">#number of chains to generate</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="dv">6000</span>     <span class="co">#length of chains</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co">#burn-in length</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#choose overdispersed initial values</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>n, <span class="at">ncol=</span>N)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>        X[i,] <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n,s[k],x0[i],N)<span class="sc">$</span>x</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>   psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>        psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>      <span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>    rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>        rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(s[k],<span class="dv">3</span>))), <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6Ojo6ZpA6ZrY6kNtmAABmADpmOgBmZrZmtttmtv+QOgCQZgCQ2/+2ZgC2Zjq22/+2///bkDrbkJDbtpDb////tmb/25D//7b//9v///9ao903AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHiElEQVR4nO2da2PbNBSG3dGVwQpjoYYZSJv8/z+Jb0nTxPKrI50jH8fv84GZTBf7me6RlepIZqmWvgHvUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAggLKgajUsJUg3OTsoCEBBgGUFxdfwxVi4BFHQdSpXnYP/IrR0G0RBIDkKQsl5N0RBgOUFOTe0uCDvRYiCAA4E+Ta0vCDnRYiCABQE8CDItSEHgnwXoYVn84pJG8ESBHAhyLMhD4JcFyEKAlAQwIUgz4YoCEBBAAoCOBHk15CRoMNumFB8+hGX3NYENdXX4WJ/ugDJbUzQYXfW0jz+F5PcxgS9PX8/Xe4DlexakFtDhUtQcGfbtgS1bdBYhGLboK0JaivZUE4CLdBigoQbM49exkFlGqGzGokiL4IKFKFLK/HFyEhQ3XZer09V9fASm5x5EbrOIFKRjaDez88vHzp8lJytoCkdUYaMxkFt31V/7i4jB4rCDMRMu4ipaGYDxXEsFDlQlOYgJOwBKjKqYm3paYQlyFDQrASgyEbQ2/OnH30R2oda6SlBVoZgIZn1F51LbMCB/TAi+yxJzkhQRDszE8TNOEg/i1OqUX1VuJGKzic2YHpyJnUsMtFgIfIkyKIICV6ICwwFouPffPJPaDl1/i5m5ov6gmTz0qx6fwrYjAvNh11wvfk8l59ZlQ4M3GLvJg5pepPD7ejIwx9dv123Y5u2lwqs9HTM2ZvLV1WQbFkjFEco6LD73A+Um/A09D0cTi7u0yRS9IzxPkQUCupnWYfdl/AAZ2RfBWaps/nq1bGclD60kWJB3XPXc9VLklzsx+LUs02/L65Fx+j/OwoKrqTG34DoY2nimlVVFnAUhCpYcr4qT6baGVoLaiTdvM6z6Q4WnJUgjSKkO5gSC4JDwLx8859OebTpai6mkY36aFw9YF5yuc+nviLgTVBmPvorJkaL9mmTVWk+2rGzUhRlHZys4nOLsh7RYMnNqIolTlaPuZOo9LjBNNUDDqRNVhMyuoxpsmSrHjA3ueSMbL42cigoMSejr9X8CUrMyeprR4+CkrIy8uNRUFJWVn7uRZDd9iuXgsR5GW5P8yhInJfl9r17EGS6vdGnIFlmln58CpJlZrs/1qkgQW7G+4cLC4o9plkiKO+O1JIvu9Qbn5v1BvT1C8q8EbX0C39ZEJud/RsM6gF1kosWlHsjahmUFhSZ32YFReZn/5qZX0FRGZr78SsoKsMC7ymuXFD+jahlUVyQUpBczL44lJ3dkRakyJvA6gE7xGd3TAZR6unyMBEkP7sjKUyR8yxMBMnP7kgKU8JP6RIUu9wRled6BSWc3ZEQqMyJMUa9mPjsjulAqt99pOF4HARCFTpyaMWCdG4k5xbSAl7w+hTcRZU9WS91ZpVRN5++iTMyWLEzvWxK0Nh5ZZegoIdyZ56Z9WJd/5UvKBCu4JlwZm1Q/fCiIWgyYMkz8+wa6XbCqiLo9jXbomcKGvZir08/KQg6Xr9mW/jIRctu/rALb5aWJVddIr+RHHwPFB1AQYDCgpaqKOk4H0kvj00Jiji7YzWYCMKvQ8UlmrekaJt6ZnD0OlRconcsSCdRCsr7ewragKDQ2R1xiW5AUF6iFJT39xS0eUH3BAUBlCer94fyZPX+MJms3hMmk9V7go00gIIAFASgIAAFASgIQEEAfUH7Chxrfk3/AsjXD1FvL+YZDnpOjj6HuqDudPzgL9tMcdi1oZvuLPRz1NsLkGe/Lzk5+izagobd+JJzhYfdRs34q0Fd1NuLedpJdCsoOfo82oLOjyuM1/5Dn6PeXszHbR7/bAUlR59HXVD3A3bBd13C1O3znKLeXqAsuzYoNTpAW9BQ5cUVv9s/e456ezEXtatI/U+CpEVH+BC0P7XRCU/YvXi0IkFJxXrYf51WR/owK6piKQ1jc7k/XdrKNuMa8PeVNNIJXevpLbSMfrpeTzcvH5y9Pp1ezksf6dXrGSj2ZV50T2Md6eKco95ezDNMNZKjz8HJKoCCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEWJWg4ZXHsq+srUrQsCOqLKsSlLlZLIlVCWoWeCHUoaDDX0/9jqHbQ8/rL5Mfm+JQUP349/H128SZ58NJsnVZQ/4EjXtTfx3+rx73aL5XrsINkT9Bg4C330Id1sxJsha4FfQc0lC4r/cnaFBzKieXVWz4bPNV7Lh/+ON42E39MkW/5XnzjfTx+O/vVfXL5C93dOWp8NEPHgW5goIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAvwP8qbycIn3nqIAAAAASUVORK5CYII=" /><!-- --></p>
<p>Run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat{R} &lt;
1.2\)</span>：</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)     <span class="co">#parameter of proposal distribution</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">4</span>          <span class="co">#number of chains to generate</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="dv">6000</span>      <span class="co">#length of chains</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co">#burn-in length</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, s[<span class="dv">1</span>], x0, N)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, s[<span class="dv">2</span>], x0, N)</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, s[<span class="dv">3</span>], x0, N)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, s[<span class="dv">4</span>], x0, N)</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    refline <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>), <span class="at">df=</span>n)</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    rw <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x,  rw4<span class="sc">$</span>x)</span></code></pre></div>
</div>
<div id="exercise-9.7" class="section level3">
<h3>Exercise 9.7</h3>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9. Plot the generated sample after
discarding a suitable burn-in sample. Fit a simple linear regression
model <span class="math inline">\(Y = β_0 + β_1X\)</span> to the sample
and check the residuals of the model for normality and constant
variance.</p>
<p>Then use the Gelman-Rubin method to monitor convergence of the chain,
and run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat{R} &lt;
1.2\)</span>.</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> .<span class="dv">9</span> <span class="co">#correlation</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>x01<span class="ot">&lt;-</span>mu1 <span class="co">#initialize</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>x02<span class="ot">&lt;-</span>mu2</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>NG<span class="ot">&lt;-</span><span class="cf">function</span>(N,mu1,mu2,sigma1,sigma2,rho,x01,x02){</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,]<span class="sc">&lt;</span><span class="fu">c</span>(x01,x02)</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>                    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>                    m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>                    X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>                    x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>                    m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>                    X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>  X1<span class="ot">&lt;-</span>X[,<span class="dv">1</span>]</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>X2<span class="ot">&lt;-</span>X[,<span class="dv">2</span>]</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X1=</span>X1,<span class="at">Y1=</span>X2))</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Generated sample after discarding a suitable burn-in which we choose
b=1000,then plot the burn-in sample:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">NG</span>(N,mu1,mu2,sigma1,sigma2,rho,x01,x02)<span class="sc">$</span>X1</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">NG</span>(N,mu1,mu2,sigma1,sigma2,rho,x01,x02)<span class="sc">$</span>Y1</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span>x[b<span class="sc">:</span>N]</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span>y[b<span class="sc">:</span>N]</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Y,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="fu">c</span>(<span class="fu">expression</span>(X),<span class="fu">expression</span>(Y)),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
Fit a simple linear regression model <span class="math inline">\(Y = β_0
+ β_1X\)</span> to the sample:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>l<span class="ot">=</span><span class="fu">lm</span>(Y<span class="sc">~</span>X)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>X))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4764 -0.7157  0.0182  0.6934  3.6909 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.09737    0.01597  -6.097 1.18e-09 ***
## X            0.05525    0.01532   3.605 0.000315 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.006 on 3998 degrees of freedom
## Multiple R-squared:  0.003241,   Adjusted R-squared:  0.002991 
## F-statistic:    13 on 1 and 3998 DF,  p-value: 0.0003155</code></pre>
<p>It can be seen that , if we asumme that Y = 0.9X and Var(X) = V ar(Y
) = 1, then Cor(X, Y ) = Cor(X, 0.9X)=0.9,we may have a fitted
model.</p>
<p>The qq plot of the residual of the generated chain (after discarding
the burn-in sample) is shown below.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">qqnorm</span>(l<span class="sc">$</span>res, <span class="at">cex =</span> <span class="fl">0.25</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">qqline</span>(l<span class="sc">$</span>res)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
The QQ plot of residuals is consistent with the normal error assumption
of the linear model.So we may accept the normality assumption.</p>
<p>For residual plots can be generated as shown below.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(l<span class="sc">$</span>fit, l<span class="sc">$</span>res, <span class="at">cex =</span> <span class="fl">0.25</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAV1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6OpA6kJA6kNtmAABmOpBmtv+QOgCQ2/+2ZgC2/7a2///bkDrb25Db2//b/7bb////tmb/25D//7b//9v///9KOnf9AAAACXBIWXMAAA7DAAAOwwHHb6hkAAALR0lEQVR4nO2dAX/iOA7FNe3M3l27M2WHuy1t8/0/5xESy7Lj5NmJDYF977c7JWDLzr+SLAcapKMWJbeewN5FQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEVBmQ3I1uBaiuuXYiIKA7AHRblgRUa3SGWK2GNzHXTgQEREBADwWohVECqmVzxeAnkW9v9czdRo0AHURePv793n2+/qxhrlj1zLcBdHh+7w4X7zmeH202ly2ZPKhnslrDsy5+8/FHD+j09DuwUrxJLlIDq40AvZz//fpfdxUPahutbULs6PxmQLXVXLLrUjjJ4uGa0So2vOg4LF8nmcnRNQFh6zsE1MDcmglUmPRdAxL9Kekm/yhAia4KSGYAbRypqPsuAMlM1ymzrSOVd78loHjBkvh5f6T/rKy01kfpLgBFxxacaCYaDgNA+aPdI6AoflK0xP1QF5OgbehOm3452xvWMhe6h3/K5ePQjcQ8LdolXUw+GqBk63hlT+Css+zvF1Cij4QHcdqxIZYe5HEBDQFjwya6JjAAck+NCWmaqBsW8HUArb3cYZq7bHMxogElI5ARkCitMN6kKz2TfXvQhKOoH4n/T51HRq9xaAJAhUPPhiloX0tFgLwX6CmPLuIoqdMMUILMZEe0npg3w30DihuLX8dd+eNdJ6oHfCR2nlQBoNKJ7gJQZzylc8Gk8eW8ymUk/3PD7O8AULBUjS7kcrALq+gzYSMYE6GlleJ8LYWnWUWZGeDy0KVhTUHiCTk/6qwLuRfGwNJeBedy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" /><!-- -->
The plot of residuals vs fits suggests that the error variance is
constant as it dosen’t have any tendency .</p>
<p>Use the Gelman-Rubin method to monitor convergence of the chain:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">6000</span> <span class="co">#length of chain</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> .<span class="dv">9</span> <span class="co">#correlation</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>x01<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>) <span class="co">#initialize</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>x02<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#choose overdispersed initial values</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23456</span>)</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>n, <span class="at">ncol=</span>N)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>n, <span class="at">ncol=</span>N)</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>       { </span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>      x[i,] <span class="ot">&lt;-</span> <span class="fu">NG</span>(N,mu1,mu2,sigma1,sigma2,rho,x01[i],x02[i])<span class="sc">$</span>X1</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>      y[i,] <span class="ot">&lt;-</span> <span class="fu">NG</span>(N,mu1,mu2,sigma1,sigma2,rho,x01[i],x02[i])<span class="sc">$</span>Y1}</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>   psi1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(x, <span class="dv">1</span>, cumsum))</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>   psi2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(y, <span class="dv">1</span>, cumsum))</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi1))</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>        {psi1[i,] <span class="ot">&lt;-</span> psi1[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi1))</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>         psi2[i,] <span class="ot">&lt;-</span> psi2[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi2))</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>         }</span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>      <span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>    rhat1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>    rhat2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>        {rhat1[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi1[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a>        rhat2[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi2[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rhat1[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&#39;X&#39;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rhat2[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&#39;Y&#39;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
It can be noted that the convergence rate of chain X is slower than
chain Y</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">6000</span> <span class="co">#length of chain</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> .<span class="dv">9</span> <span class="co">#correlation</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">NG</span>(N,mu1,mu2,sigma1,sigma2,rho,<span class="dv">0</span>,<span class="dv">0</span>)<span class="sc">$</span>X1</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">NG</span>(N,mu1,mu2,sigma1,sigma2,rho,<span class="dv">0</span>,<span class="dv">0</span>)<span class="sc">$</span>Y1</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>    refline <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>), <span class="at">df=</span>n)</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>    c1<span class="ot">&lt;-</span>x2[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>(c1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(c1))</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">abline</span>(<span class="at">h=</span>refline)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>    c2<span class="ot">&lt;-</span>y2[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(c2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylab=</span><span class="st">&quot;Y&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(c2))</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">abline</span>(<span class="at">h=</span>refline)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>###A-22001-2022-11-04</p>
</div>
<div id="hw1" class="section level3">
<h3>HW1</h3>
<p>The test of Intermediary effect</p>
<p><span class="math display">\[H_0:
\alpha\beta=0  \leftrightarrow   H_1:\alpha\beta\neq0\]</span> the test
statistics is<span class="math display">\[T=\frac{\hat{\alpha}\hat{\beta}}{\hat{se}(\hat{\alpha}\hat{\beta})}\]</span>
Design a randomized simulation experiment,consider the performance of
the above three permutation test methods.</p>
<p>Consider the model:</p>
<p><span class="math display">\[M=a_M+\alpha X+e_M\]</span></p>
<p><span class="math display">\[Y=a_Y+\beta M+\gamma X+e_Y\]</span>
<span class="math inline">\(e_M,e_Y\sim N(0,1)\)</span></p>
<p>How to design the permutation that we can proof :</p>
<p><span class="math display">\[(1)\alpha=0\]</span> <span class="math display">\[(2)\beta=0\]</span> <span class="math display">\[(3)\alpha=0 and \beta=0\]</span></p>
<p>when we consider that:</p>
<p><span class="math display">\[① \alpha=0,\beta=1;
②  \alpha=1,\beta=0;③\alpha=0,\beta=0\]</span></p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mediation)</span></code></pre></div>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loading required package: lpSolve</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## Warning: package &#39;sandwich&#39; was built under R version 4.2.2</code></pre>
<pre><code>## mediation: R Package for Causal Mediation Analysis
## Version: 4.3</code></pre>
<pre><code>## 
## Attaching package: &#39;mediation&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     jobs</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2345</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">50</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>em<span class="ot">&lt;-</span><span class="fu">rnorm</span>(N)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>ey<span class="ot">&lt;-</span><span class="fu">rnorm</span>(N)</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">rnorm</span>(N)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>r<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>am<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>ay<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>per <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, dims) {</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> dims[<span class="dv">1</span>] </span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> dims[<span class="dv">2</span>] </span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> p <span class="sc">+</span> q </span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> z[ <span class="dv">1</span><span class="sc">:</span>p,] </span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> z[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>p),ix] </span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">c</span>(<span class="at">X1=</span>x,<span class="at">Y1=</span>y)) }</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a><span class="co">#for only X independent with M;</span></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>perm1<span class="ot">&lt;-</span><span class="cf">function</span>(X,M,Y,n){</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">lm</span>(M<span class="sc">~</span>X)</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">&lt;-</span><span class="fu">lm</span>(Y<span class="sc">~</span>M<span class="sc">+</span>X)</span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>  re<span class="ot">=</span><span class="fu">mediate</span>(a,b,<span class="at">treat=</span><span class="st">&#39;X&#39;</span>,<span class="at">mediator=</span><span class="st">&#39;M&#39;</span>,<span class="at">sims=</span><span class="dv">20</span>)</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">=</span>re<span class="sc">$</span>d0</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>  se<span class="ot">=</span><span class="fu">sd</span>(re<span class="sc">$</span>d0.sim)</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>  T0<span class="ot">=</span>c<span class="sc">/</span>se</span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>  t<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>    X<span class="ot">&lt;-</span> <span class="fu">sample</span>(X);</span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Y))</span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> Y[k]; </span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>    M <span class="ot">&lt;-</span> M[k];</span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span><span class="fu">lm</span>(M<span class="sc">~</span>X)</span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>    b<span class="ot">&lt;-</span><span class="fu">lm</span>(Y<span class="sc">~</span>M<span class="sc">+</span>X)</span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>    re<span class="ot">=</span><span class="fu">mediate</span>(a,b,<span class="at">treat=</span><span class="st">&#39;X&#39;</span>,<span class="at">mediator=</span><span class="st">&#39;M&#39;</span>,<span class="at">sims=</span><span class="dv">20</span>)</span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a>    c<span class="ot">=</span>re<span class="sc">$</span>d0</span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a>    se<span class="ot">=</span><span class="fu">sd</span>(re<span class="sc">$</span>d0.sim)</span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a>    t[i]<span class="ot">=</span>c<span class="sc">/</span>se</span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-40"><a href="#cb107-40" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,t))<span class="sc">&gt;=</span><span class="fu">abs</span>(T0))</span>
<span id="cb107-41"><a href="#cb107-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb107-42"><a href="#cb107-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-43"><a href="#cb107-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-44"><a href="#cb107-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-45"><a href="#cb107-45" aria-hidden="true" tabindex="-1"></a><span class="co">#for only M independent with Y;</span></span>
<span id="cb107-46"><a href="#cb107-46" aria-hidden="true" tabindex="-1"></a>perm2<span class="ot">&lt;-</span><span class="cf">function</span>(X,M,Y,n){</span>
<span id="cb107-47"><a href="#cb107-47" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">lm</span>(M<span class="sc">~</span>X)</span>
<span id="cb107-48"><a href="#cb107-48" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">&lt;-</span><span class="fu">lm</span>(Y<span class="sc">~</span>M<span class="sc">+</span>X)</span>
<span id="cb107-49"><a href="#cb107-49" aria-hidden="true" tabindex="-1"></a>  re<span class="ot">=</span><span class="fu">mediate</span>(a,b,<span class="at">treat=</span><span class="st">&#39;X&#39;</span>,<span class="at">mediator=</span><span class="st">&#39;M&#39;</span>,<span class="at">sims=</span><span class="dv">20</span>)</span>
<span id="cb107-50"><a href="#cb107-50" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">=</span>re<span class="sc">$</span>d0</span>
<span id="cb107-51"><a href="#cb107-51" aria-hidden="true" tabindex="-1"></a>  se<span class="ot">=</span><span class="fu">sd</span>(re<span class="sc">$</span>d0.sim)</span>
<span id="cb107-52"><a href="#cb107-52" aria-hidden="true" tabindex="-1"></a>  T0<span class="ot">=</span>c<span class="sc">/</span>se</span>
<span id="cb107-53"><a href="#cb107-53" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb107-54"><a href="#cb107-54" aria-hidden="true" tabindex="-1"></a>  t<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb107-55"><a href="#cb107-55" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb107-56"><a href="#cb107-56" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X))</span>
<span id="cb107-57"><a href="#cb107-57" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> X[k]; </span>
<span id="cb107-58"><a href="#cb107-58" aria-hidden="true" tabindex="-1"></a>    M <span class="ot">&lt;-</span> M[k];</span>
<span id="cb107-59"><a href="#cb107-59" aria-hidden="true" tabindex="-1"></a>    Y<span class="ot">&lt;-</span> <span class="fu">sample</span>(Y);</span>
<span id="cb107-60"><a href="#cb107-60" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span><span class="fu">lm</span>(M<span class="sc">~</span>X)</span>
<span id="cb107-61"><a href="#cb107-61" aria-hidden="true" tabindex="-1"></a>    b<span class="ot">&lt;-</span><span class="fu">lm</span>(Y<span class="sc">~</span>M<span class="sc">+</span>X)</span>
<span id="cb107-62"><a href="#cb107-62" aria-hidden="true" tabindex="-1"></a>    re<span class="ot">=</span><span class="fu">mediate</span>(a,b,<span class="at">treat=</span><span class="st">&#39;X&#39;</span>,<span class="at">mediator=</span><span class="st">&#39;M&#39;</span>,<span class="at">sims=</span><span class="dv">100</span>)</span>
<span id="cb107-63"><a href="#cb107-63" aria-hidden="true" tabindex="-1"></a>    c<span class="ot">=</span>re<span class="sc">$</span>d0</span>
<span id="cb107-64"><a href="#cb107-64" aria-hidden="true" tabindex="-1"></a>    se<span class="ot">=</span><span class="fu">sd</span>(re<span class="sc">$</span>d0.sim)</span>
<span id="cb107-65"><a href="#cb107-65" aria-hidden="true" tabindex="-1"></a>    t[i]<span class="ot">=</span>c<span class="sc">/</span>se</span>
<span id="cb107-66"><a href="#cb107-66" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-67"><a href="#cb107-67" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,t))<span class="sc">&gt;=</span><span class="fu">abs</span>(T0))</span>
<span id="cb107-68"><a href="#cb107-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb107-69"><a href="#cb107-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-70"><a href="#cb107-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-71"><a href="#cb107-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-72"><a href="#cb107-72" aria-hidden="true" tabindex="-1"></a><span class="co">#for X independent with M;M independent with y</span></span>
<span id="cb107-73"><a href="#cb107-73" aria-hidden="true" tabindex="-1"></a>perm3<span class="ot">&lt;-</span><span class="cf">function</span>(X,M,Y,n){</span>
<span id="cb107-74"><a href="#cb107-74" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">lm</span>(M<span class="sc">~</span>X)</span>
<span id="cb107-75"><a href="#cb107-75" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">&lt;-</span><span class="fu">lm</span>(Y<span class="sc">~</span>M<span class="sc">+</span>X)</span>
<span id="cb107-76"><a href="#cb107-76" aria-hidden="true" tabindex="-1"></a>  re<span class="ot">=</span><span class="fu">mediate</span>(a,b,<span class="at">treat=</span><span class="st">&#39;X&#39;</span>,<span class="at">mediator=</span><span class="st">&#39;M&#39;</span>,<span class="at">sims=</span><span class="dv">20</span>)</span>
<span id="cb107-77"><a href="#cb107-77" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">=</span>re<span class="sc">$</span>d0</span>
<span id="cb107-78"><a href="#cb107-78" aria-hidden="true" tabindex="-1"></a>  se<span class="ot">=</span><span class="fu">sd</span>(re<span class="sc">$</span>d0.sim)</span>
<span id="cb107-79"><a href="#cb107-79" aria-hidden="true" tabindex="-1"></a>  T0<span class="ot">=</span>c<span class="sc">/</span>se</span>
<span id="cb107-80"><a href="#cb107-80" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb107-81"><a href="#cb107-81" aria-hidden="true" tabindex="-1"></a>  t<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb107-82"><a href="#cb107-82" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb107-83"><a href="#cb107-83" aria-hidden="true" tabindex="-1"></a>    X<span class="ot">&lt;-</span> <span class="fu">sample</span>(X);</span>
<span id="cb107-84"><a href="#cb107-84" aria-hidden="true" tabindex="-1"></a>    M<span class="ot">&lt;-</span>M</span>
<span id="cb107-85"><a href="#cb107-85" aria-hidden="true" tabindex="-1"></a>    Y<span class="ot">&lt;-</span><span class="fu">sample</span>(Y);</span>
<span id="cb107-86"><a href="#cb107-86" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span><span class="fu">lm</span>(M<span class="sc">~</span>X)</span>
<span id="cb107-87"><a href="#cb107-87" aria-hidden="true" tabindex="-1"></a>    b<span class="ot">&lt;-</span><span class="fu">lm</span>(Y<span class="sc">~</span>M<span class="sc">+</span>X)</span>
<span id="cb107-88"><a href="#cb107-88" aria-hidden="true" tabindex="-1"></a>    re<span class="ot">=</span><span class="fu">mediate</span>(a,b,<span class="at">treat=</span><span class="st">&#39;X&#39;</span>,<span class="at">mediator=</span><span class="st">&#39;M&#39;</span>,<span class="at">sims=</span><span class="dv">20</span>)</span>
<span id="cb107-89"><a href="#cb107-89" aria-hidden="true" tabindex="-1"></a>    c<span class="ot">=</span>re<span class="sc">$</span>d0</span>
<span id="cb107-90"><a href="#cb107-90" aria-hidden="true" tabindex="-1"></a>    se<span class="ot">=</span><span class="fu">sd</span>(re<span class="sc">$</span>d0.sim)</span>
<span id="cb107-91"><a href="#cb107-91" aria-hidden="true" tabindex="-1"></a>    t[i]<span class="ot">=</span>c<span class="sc">/</span>se</span>
<span id="cb107-92"><a href="#cb107-92" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-93"><a href="#cb107-93" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,t))<span class="sc">&gt;=</span><span class="fu">abs</span>(T0))</span>
<span id="cb107-94"><a href="#cb107-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb107-95"><a href="#cb107-95" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><span class="math inline">\(① \alpha=0,\beta=1;\)</span>:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="dv">0</span>;beta<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span>am<span class="sc">+</span>alpha<span class="sc">*</span>X<span class="sc">+</span>em</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span>ay<span class="sc">+</span>beta<span class="sc">*</span>M<span class="sc">+</span>r<span class="sc">*</span>X<span class="sc">+</span>ey</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">perm1</span>(X,M,Y,n)<span class="co">#model1</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">perm2</span>(X,M,Y,n)<span class="co">#model2</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">perm3</span>(X,M,Y,n)<span class="co">#model3</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p1,p2,p3)</span></code></pre></div>
<pre><code>## [1] 0.77227723 0.03960396 0.34653465</code></pre>
<p>we choose three permutation test methods show above. All the p-value
are large enough(&gt;0.05) that we can’t reject the null hypothesis
while p2=0.08910891 seem small.</p>
<p><span class="math inline">\(② \alpha=1,\beta=0;\)</span></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">50</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="dv">1</span>;beta<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span>am<span class="sc">+</span>alpha<span class="sc">*</span>X<span class="sc">+</span>em</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span>ay<span class="sc">+</span>beta<span class="sc">*</span>M<span class="sc">+</span>r<span class="sc">*</span>X<span class="sc">+</span>ey</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">perm1</span>(X,M,Y,n)<span class="co">#model1</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">perm2</span>(X,M,Y,n)<span class="co">#model2</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">perm3</span>(X,M,Y,n)<span class="co">#model3</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p1,p2,p3)</span></code></pre></div>
<pre><code>## [1] 0.5490196 0.5294118 0.1176471</code></pre>
<p>All the p-value are large enough(&gt;0.05) that we can’t reject the
null hypothesis while p3=0.07920792 seem small.</p>
<p><span class="math inline">\(③\alpha=0,\beta=0\)</span></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">50</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="dv">0</span>;beta<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span>am<span class="sc">+</span>alpha<span class="sc">*</span>X<span class="sc">+</span>em</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span>ay<span class="sc">+</span>beta<span class="sc">*</span>M<span class="sc">+</span>r<span class="sc">*</span>X<span class="sc">+</span>ey</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">perm1</span>(X,M,Y,n)<span class="co">#model1</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">perm2</span>(X,M,Y,n)<span class="co">#model2</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">perm3</span>(X,M,Y,n)<span class="co">#model3</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p1,p2,p3)</span></code></pre></div>
<pre><code>## [1] 0.4117647 0.4705882 0.8235294</code></pre>
<p>All the p-value are large that we can’t reject the null
hypothesis.</p>
</div>
<div id="hw2" class="section level3">
<h3>HW2</h3>
<p>Consider the model:</p>
<p><span class="math display">\[P(Y_1|X_1,X_2,X_3)=expit(\alpha+b_1X_1+b_2X_2+b_3X_3)\]</span></p>
<p><span class="math inline">\(X_1\sim P(1)\)</span>,<span class="math inline">\(X_2\sim Exp(1)\)</span>,<span class="math inline">\(X_3\sim B(1,0.5)\)</span></p>
<p>Write a function which we imput <span class="math inline">\(N,b_1,b_2,b_3,f_0\)</span> then we may get the
output <span class="math inline">\(\alpha\)</span></p>
<p>We use the function and choose <span class="math inline">\(N=10^6,b_1=0,b_2=1,b_3=-1\)</span></p>
<p><span class="math inline">\(f_0=0.1,0.01,0.001,0.0001\)</span></p>
<p>graph the scatter plot of <span class="math inline">\(f_0\)</span> vs
<span class="math inline">\(\alpha\)</span></p>
<p><strong>Solution.</strong> Write the function which can help us
calculate <span class="math inline">\(\alpha\)</span>:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>);x2<span class="ot">&lt;-</span><span class="fu">rexp</span>(N,<span class="dv">1</span>); x3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="cf">function</span>(x1,x2,x3,N,f0){</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">5</span>))</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">unlist</span>(solution),<span class="dv">5</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(solution<span class="sc">$</span>root)</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Choose <span class="math inline">\(N=10^6,b_1=0,b_2=1,b_3=-1\)</span></p>
<p><span class="math inline">\(f_0=0.1,0.01,0.001,0.0001\)</span>,then
have <span class="math inline">\(\alpha\)</span> solved as follows:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span>; b1 <span class="ot">&lt;-</span> <span class="dv">0</span>; b2 <span class="ot">&lt;-</span> <span class="dv">1</span>;b3<span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span>;</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  f0<span class="ot">&lt;-</span>f1[i]</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>alpha[i] <span class="ot">&lt;-</span> <span class="fu">s</span>(b1,b2,b3,N,f0)</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>alpha</span></code></pre></div>
<pre><code>## [1]  -4.197234  -6.595120  -8.906759 -11.210242</code></pre>
<p>graph the scatter plot of <span class="math inline">\(f_0\)</span> vs
<span class="math inline">\(\alpha\)</span>:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f1,alpha,<span class="at">xlab=</span><span class="st">&#39;f0&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="fu">log</span>(f1),alpha,<span class="at">xlab=</span><span class="st">&#39;-log(f0)&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
It can be noted that <span class="math inline">\(\alpha\)</span>
increases along with <span class="math inline">\(f_0\)</span>,and
decrease with <span class="math inline">\(-log(f_0)\)</span>.</p>
<p>###A-22001-2022-11-11</p>
</div>
<div id="class-work" class="section level3">
<h3>Class Work</h3>
<p><span class="math inline">\(X_1,……,X_n\)</span> <span class="math inline">\(\sim_{iid}\)</span> <span class="math inline">\(Exp(\lambda)\)</span>.With some information missed
,we just know that <span class="math inline">\(X_i\in
(u_i,v_i)\)</span>,where <span class="math inline">\(u_i&lt;v_i\)</span>,and they are constant.</p>
<p>(1)Maximize the likelihood function of observation and use EM
algorithm to estimate <span class="math inline">\(\lambda\)</span>
.Prove both of them are equal.</p>
<p>(2)We have some
observation(n=10):(11,12),(8,9),(27,28),(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3).Use
them realize two methods show above to estimate <span class="math inline">\(\lambda\)</span>.</p>
<p><strong>Solution.</strong></p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>The likelihood function with observation:</p>
<p><span class="math display">\[L_o(\lambda)=\prod_{i=1}^{n}P(u_i&lt;X_i&lt;v_i)=\prod_{i=1}^{n}(e^{-\lambda
u_i}-e^{-\lambda v_i})\]</span> The log-likelihood function:</p>
<p><span class="math display">\[l_o(\lambda)=\sum_{i=1}^{n}log(e^{-\lambda
u_i}-e^{-\lambda v_i})\]</span> Derive <span class="math inline">\(l_o\)</span> with respect to <span class="math inline">\(\lambda\)</span> and equal to 0,Then the MLE of
<span class="math inline">\(\lambda\)</span> is the solution of the
equation shown as follows:</p>
<p><span class="math display">\[\sum_{i=1}^{n}\frac{v_ie^{-\lambda
v_i}-u_ie^{-\lambda u_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}=0\]</span>
While this equation is hardly to solve ,we may choose EM:</p>
<p>The likelyhood function with completed data:</p>
<p><span class="math display">\[L_c(\lambda)=\prod_{i=1}^{n}
f(X_i)=\lambda^{n}e^{-\sum_{i=1}^{n}\lambda X_i}\]</span> The log-
likelyhood function:</p>
<p><span class="math display">\[l_c(\lambda)=nlog(\lambda)-\sum_{i=1}^{n}\lambda
X_i\]</span> E-step:We may maximize the conditional expectation of <span class="math inline">\(l_c(\lambda)\)</span>:</p>
<p><span class="math display">\[E_{\lambda^{0}}(l_c(\lambda)|u_i&lt;X_i&lt;v_i,i=1…n)=nlog(\lambda)-\sum_{i=1}^{n}\lambda
\hat{X_i}\]</span> Where <span class="math inline">\(\hat{X_i}=E_{\lambda^{0}}(X_i|u_i&lt;X_i&lt;v_i,i=1…n)\)</span></p>
<p>M-step:We can derive that:</p>
<p><span class="math display">\[\lambda^{(1)}=\frac{n}{\sum_{i=1}^{n}\hat{X_i}}\]</span>
repeat that until the error small enough so that <span class="math inline">\(\lambda\)</span> convergence.</p>
<p>We may need to calculate <span class="math inline">\(\hat{X_i}\)</span>:</p>
<p>since<span class="math display">\[\hat{X_i}=E_{\lambda^{0}}(X_i|u_i&lt;X_i&lt;v_i,i=1…n)\]</span></p>
<p><span class="math display">\[f(x|u_i&lt;X_i&lt;v_i,\lambda^{0})=\frac{\lambda^{0}e^{-\lambda^{0}x}I_{[u_i,v_i]}}{e^{-\lambda^{0}
u_i}-e^{-\lambda^{0} v_i}}\]</span> <span class="math display">\[\hat{X_i}=\int
xf(x|u_i&lt;X_i&lt;v_i,\lambda^{0})dx=\frac{u_ie^{-\lambda^{0}
u_i}-v_ie^{-\lambda^{0} v_i}}{e^{-\lambda^{0} u_i}-e^{-\lambda^{0}
v_i}}+\frac{1}{\lambda^0}\]</span> then <span class="math display">\[\lambda^{(k+1)}=\frac{n\lambda^{(k)}}{\sum_{i=1}^{n}(\lambda^{(k)}\frac{u_ie^{-\lambda^{(k)}
u_i}-v_ie^{-\lambda^{(k)} v_i}}{e^{-\lambda^{(k)} u_i}-e^{-\lambda^{(k)}
v_i}}+1)}\]</span> We may assume <span class="math inline">\(\lim\lambda^{(k)}=\lambda\)</span></p>
<p>then <span class="math display">\[\lambda=\frac{n\lambda}{\sum_{i=1}^{n}(\lambda\frac{u_ie^{-\lambda
u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}+1)}
\Rightarrow \sum_{i=1}^{n}\frac{u_ie^{-\lambda u_i}-v_ie^{-\lambda
v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}=0\]</span> It means <span class="math inline">\(\lambda^{(k)}\)</span> is convergence,and it may
converge to <span class="math inline">\(\lambda_{ML}\)</span> ,which
satisfies <span class="math inline">\(\sum_{i=1}^{n}\frac{u_ie^{-\lambda
u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}=0\)</span></p>
<p>We may have the recursive :</p>
<p><span class="math display">\[\lambda^{(k+1)}=\frac{n}{\sum_{i=1}^{n}(\frac{u_ie^{-\lambda^{(k)}
u_i}-v_ie^{-\lambda^{(k)} v_i}}{e^{-\lambda^{(k)} u_i}-e^{-\lambda^{(k)}
v_i}}+\frac{1}{\lambda^{(k)}})}=f(\lambda^{k})\]</span> Then</p>
<p><span class="math display">\[\frac{df(x)}{dx}=\frac{n(\sum_{i=1}^{n}\frac{(u_i^2e^{-x
u_i}-v_i^2e^{-x v_i})(e^{-x u_i}-e^{-x v_i})+(u_ie^{-x u_i}-v_ie^{-x
v_i})^2}{(e^{-x u_i}-e^{-x
v_i})^2}+\frac{1}{x^2})}{(\sum_{i=1}^{n}(\frac{u_ie^{-x u_i}-v_ie^{-x
v_i}}{e^{- xu_i}-e^{-x v_i}}+\frac{1}{x}))^2}\]</span> we may have <span class="math inline">\(0&lt;f^{&#39;}(x)&lt;\frac{1}{n}&lt;1\)</span>
since <span class="math inline">\(\sum_{i=1}^{n}\frac{u_ie^{-\lambda
u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}\rightarrow0\)</span> then under the contraction mapping
theorem:</p>
<p><span class="math display">\[|\lambda^{k+1}-\lambda^{k}|\leq|f^{&#39;}(x)|
|\lambda^{k}-\lambda^{k-1}|\leq|f^{&#39;}(x)|^{k}
|\lambda^{1}-\lambda^{0}|\rightarrow0\]</span> While <span class="math inline">\(n\rightarrow0\)</span>.i.e. <span class="math inline">\(\lambda^{k}\)</span> estimated by EM algorithm
convergence to <span class="math inline">\(\hat{\lambda}_{ML}\)</span>
estimated by ML.</p>
<p>(2).</p>
<p>Estimate <span class="math inline">\(\lambda\)</span> by two methods
with 10 observed data：</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats4)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>v<span class="ot">=</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>lo<span class="ot">&lt;-</span><span class="cf">function</span>(lambda){</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  sum<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>    sum<span class="ot">=</span>sum<span class="sc">+</span>(v[i]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v[i])<span class="sc">-</span>u[i]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u[i]))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u[i])<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v[i]))</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>  sum</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>sol <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(lo,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>sol</span></code></pre></div>
<pre><code>## $root
## [1] 0.07196821
## 
## $f.root
## [1] 0.01019994
## 
## $iter
## [1] 10
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<p>EM:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>lambda0<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>e<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (e<span class="sc">&gt;</span><span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">6</span>)){</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">=</span>n<span class="sc">/</span>(<span class="sc">-</span><span class="fu">lo</span>(lambda0)<span class="sc">+</span>n<span class="sc">/</span>lambda0)</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>  e<span class="ot">=</span><span class="fu">abs</span>(lambda<span class="sc">-</span>lambda0)</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>  lambda0<span class="ot">=</span>lambda</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>lambda0</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
<p>We estimate <span class="math inline">\(\lambda\)</span> by using ML
function is 0.07196821; and EM algorithm is 0.0719735.Both of them are
quite closed.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) </span></code></pre></div>
</div>
<div id="exercise-2.1.34" class="section level3">
<h3>Exercise 2.1.3(4)</h3>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
<p><strong>Solution.</strong></p>
<p>We need to get rid of the nested structure.</p>
<p>Where possible the list elements are coerced to a common mode during
the unlisting, and so the result often ends up as a character vector.
Vectors will be coerced to the highest type of the components in the
hierarchy NULL &lt; raw &lt; logical &lt; integer &lt; double &lt;
complex &lt; character &lt; list &lt; expression: pairlists are treated
as lists.</p>
<p>A list is a (generic) vector, and the simplified vector might still
be a list (and might be unchanged). Non-vector elements of the list (for
example language elements such as names, formulas and calls) are not
coerced, and so a list containing one or more of these remains a list.
(The effect of unlisting an lm fit is a list which has individual
residuals as components.) Note that unlist(x) now returns x unchanged
also for non-vector x, instead of signalling an error in that case.</p>
</div>
<div id="exercise-2.1.35" class="section level3">
<h3>Exercise 2.1.3(5)</h3>
<p>Why is 1 == “1” true? Why is -1 &lt; FALSE true? Why is “one” &lt; 2
false?</p>
<p><strong>Solution.</strong> These are all functions which coerco their
arguments to character , double and character.</p>
<p>1 == “1” is TRUE</p>
<p>“FALSE==0” is TRUE then -1 &lt; FALSE true</p>
<p>‘one’ comes after ‘2’ in ASCⅡ</p>
</div>
<div id="exercise-2.3.11" class="section level3">
<h3>Exercise 2.3.1(1)</h3>
<p>What does dim() return when applied to a vector?</p>
<p><strong>Solution.</strong></p>
<p>it may return ” NULL ”</p>
</div>
<div id="exercise-2.3.12" class="section level3">
<h3>Exercise 2.3.1(2)</h3>
<p>If is.matrix(x) is TRUE, what will is.array(x) return?</p>
<p><strong>Solution.</strong></p>
<p>It will also return “TRUE”.</p>
<p>because is.matrix returns TRUE if x is a vector and has a “dim”
attribute of length 2 and FALSE otherwise.i.e.A two-dimentional array is
the same thing as a matrix.</p>
</div>
<div id="exercise-2.4.51" class="section level3">
<h3>Exercise 2.4.5(1)</h3>
<p>What attributes does a data frame possess?</p>
<p><strong>Solution.</strong></p>
<p>A data frame posess names,row.names,class.</p>
</div>
<div id="exercise-2.4.52" class="section level3">
<h3>Exercise 2.4.5(2)</h3>
<p>What does as.matrix() do when applied to a data frame with columns of
different types?</p>
<p><strong>Solution.</strong></p>
<p>From “?as.matrix”:</p>
<p>as.matrix is a generic function. The method for data frames will
return a character matrix if there is only atomic columns and any
non-(numeric/logical/complex) column, applying as.vector to factors and
format to other non-character columns. Otherwise, the usual coercion
hierarchy (logical &lt; integer &lt; double &lt; complex) will be used,
e.g., all-logical data frames will be coerced to a logical matrix, mixed
logical-integer will give a integer matrix, etc.</p>
</div>
<div id="exercise-2.4.53" class="section level3">
<h3>Exercise 2.4.5(3)</h3>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
<p><strong>Solution.</strong></p>
<p>Yes.You can creat a data frame with 0 rows and 0 columns.Also both of
them are 0:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>iris[<span class="cn">FALSE</span>,]<span class="co">#0 rows</span></span></code></pre></div>
<pre><code>## [1] Sepal.Length Sepal.Width  Petal.Length Petal.Width  Species     
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>iris[<span class="cn">FALSE</span>,]<span class="co">#0 columns</span></span></code></pre></div>
<pre><code>## [1] Sepal.Length Sepal.Width  Petal.Length Petal.Width  Species     
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>iris[<span class="cn">FALSE</span>,<span class="cn">FALSE</span>]<span class="co">#0 columns and 0 rows</span></span></code></pre></div>
<pre><code>## data frame with 0 columns and 0 rows</code></pre>
<p>###A-22001-2022-11-18</p>
</div>
<div id="exercises-2" class="section level3">
<h3>Exercises 2</h3>
<p>The function below scales a vector so it falls in the range [0, 1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Solution.</strong></p>
<p>We can use the if() “function”,since we want to return non-numeric
input columns; and we choose the data “cars” from R:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>car<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">lapply</span>(cars, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x))</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(car)</span></code></pre></div>
<pre><code>##       speed       dist
## 1 0.0000000 0.00000000
## 2 0.0000000 0.06779661
## 3 0.1428571 0.01694915
## 4 0.1428571 0.16949153
## 5 0.1904762 0.11864407
## 6 0.2380952 0.06779661</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(car)</span></code></pre></div>
<pre><code>##        speed      dist
## 45 0.9047619 0.4406780
## 46 0.9523810 0.5762712
## 47 0.9523810 0.7627119
## 48 0.9523810 0.7711864
## 49 0.9523810 1.0000000
## 50 1.0000000 0.7033898</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) </span></code></pre></div>
</div>
<div id="exercise-1" class="section level3">
<h3>Exercise 1</h3>
<p>Use vapply() to:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the standard deviation of every column in a numeric data
frame.</p></li>
<li><p>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use vapply() twice.)</p></li>
</ol>
<p><strong>Solution.</strong></p>
<p>As a numeric data.frame we choose ‘trees’ from R:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(trees, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##     Girth    Height    Volume 
##  3.138139  6.371813 16.437846</code></pre>
<p>As a mixed data.frame we choose ‘iris’ from R:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(iris[<span class="fu">vapply</span>(iris, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))],</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>       sd, </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) </span></code></pre></div>
</div>
<div id="homework3" class="section level3">
<h3>Homework3</h3>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9.</p>
<p>• Write an Rcpp function.</p>
<p>• Compare the corresponding generated random numbers with pure R
language using the function “qqplot”.</p>
<p>• Compare the computation time of the two functions with the function
“microbenchmark”.</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: package &#39;Rcpp&#39; was built under R version 4.2.2</code></pre>
<p>1.You can see Rcpp function of Gibbs sampler in the file
“gibbsC.cpp$</p>
<ol start="2" style="list-style-type: decimal">
<li>Gissbs sample generaed by R language:</li>
</ol>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(N, thin) {</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>thin) {</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fl">0.9</span><span class="sc">*</span>y, <span class="fu">sqrt</span>(<span class="dv">1</span><span class="fl">-0.9</span><span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fl">0.9</span><span class="sc">*</span>x, <span class="fu">sqrt</span>(<span class="dv">1</span><span class="fl">-0.9</span><span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>    mat[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>  mat</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Compare the corresponding generated random numbers with pure R
language using the function “qqplot”:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2345</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.2.2</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(StatComp22001)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>gibbR<span class="ot">=</span><span class="fu">gibbsR</span>(<span class="dv">200</span>,<span class="dv">1</span>)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>gibbC<span class="ot">=</span><span class="fu">gibbsC</span>(<span class="dv">200</span>,<span class="dv">1</span>)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>X1<span class="ot">=</span>gibbR[,<span class="dv">1</span>]</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>Y1<span class="ot">=</span>gibbR[,<span class="dv">2</span>]</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>X2<span class="ot">=</span>gibbC[,<span class="dv">1</span>]</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>Y2<span class="ot">=</span>gibbC[,<span class="dv">2</span>]</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X1,Y1)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X2,Y2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X1,X2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(Y1,Y2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
Comparing the corresponding generated random numbers of the two
functions. It could be noted that they are in the linear
relationships.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbR=</span><span class="fu">gibbsR</span>(<span class="dv">200</span>,<span class="dv">1</span>),</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="at">gibbC=</span><span class="fu">gibbsC</span>(<span class="dv">200</span>,<span class="dv">1</span>))</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##    expr     lq median      uq
## 1 gibbR 697.40  754.8 1007.70
## 2 gibbC  82.25   87.4  110.45</code></pre>
<p>It can be seen that the computation time of the two functions ,gibbC
are quicker than gibbR.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
